---
import { Icon } from 'astro-icon/components';

const links = [
  { href: '/', label: 'Inicio', icon: 'mdi:home' },
  { href: '/about', label: 'Nosotros', icon: 'mdi:information' },
  { href: '/courses', label: 'Cursos', icon: 'mdi:book' },
  // { href: '#how-it-works', label: 'Reservas', icon: 'mdi:calendar' },
  { href: '/#contact', label: 'Contacto', icon: 'mdi:contact-mail' },
];

const authLinks = [
  { href: '/ingresar', label: 'Iniciar Sesión', icon: 'mdi:sign-in-variant' },
  { href: '/registro', label: 'Registrarse', icon: 'mdi:account-plus' },
  { href: '/recuperar', label: 'Recuperar Contraseña', icon: 'mdi:lock-reset' },
];
---

<!-- Navbar principal -->
<nav
  class="navbar h-navbar px-4 md:px-12 fixed top-0 bg-primary/80 backdrop-blur border-b border-base-300 z-50 flex justify-between"
>
  <!-- Mobile: Botón menú principal (izquierda) -->
  <div class="flex-none lg:hidden">
    <label for="main-drawer" aria-label="open main menu" class="btn btn-navbar btn-square">
      <Icon name="mdi:menu" size={32} />
    </label>
  </div>

  <!-- Logo/título -->
  <div class="flex-1 lg:flex-none">
    <a
      href="/"
      class="flex justify-center items-center normal-case text-xl font-bold tracking-wide gap-2 hover:bg-transparent hover:border-0 px-2"
    >
      <div class="avatar">
        <div class="w-12 h-24 rounded-full">
          <img src="/images/logo.png" alt="Salva Ramos Logo" />
        </div>
      </div>
      <span class="hidden sm:inline">Salva Ramos</span>
    </a>
  </div>

  <!-- Desktop: Menú de navegación (centro) -->
  <div class="hidden lg:flex lg:flex-1 lg:justify-center">
    <ul class="menu menu-horizontal">
      {
        links.map((link) => (
          <li>
            <a data-navlink href={link.href} class="text-lg font-medium">
              {link.label}
            </a>
          </li>
        ))
      }
    </ul>
  </div>

  <!-- Desktop: AuthLinks + Icono cuenta (derecha) -->

  <!-- Icono cuenta (siempre visible) -->
  <ul class="menu menu-horizontal">
    <li>
      <a data-navlink href="/ingresar" class="text-lg font-medium hidden lg:block">
        Iniciar Sesión
      </a>
    </li>
    <li>
      <label for="auth-drawer" aria-label="open auth menu" class="btn btn-navbar btn-square">
        <Icon name="mdi:sign-in" size={32} class="text-secondary" />
      </label>
    </li>
  </ul>
</nav>

<!-- Drawer 1: Menú principal -->
<div class="drawer z-60">
  <input id="main-drawer" type="checkbox" class="drawer-toggle" />
  <div class="drawer-content"></div>
  <div class="drawer-side">
    <label for="main-drawer" aria-label="close sidebar" class="drawer-overlay"></label>
    <ul class="menu bg-base-200 min-h-full w-80 p-4">
      <li class="menu-title">
        <span>Navegación</span>
      </li>
      {
        links.map((link) => (
          <li>
            <a data-navlink href={link.href} class="text-lg font-medium flex justify-between">
              <Icon name={link.icon} size={24} />
              <span>{link.label}</span>
            </a>
          </li>
        ))
      }
    </ul>
  </div>
</div>

<!-- Drawer 2: Menú de autenticación -->
<div class="drawer drawer-end z-60">
  <input id="auth-drawer" type="checkbox" class="drawer-toggle" />
  <div class="drawer-content"></div>
  <div class="drawer-side">
    <label for="auth-drawer" aria-label="close auth menu" class="drawer-overlay"></label>
    <ul class="menu bg-base-200 min-h-full w-80 p-4">
      <li class="menu-title text-left">
        <span>Cuenta</span>
      </li>
      {
        authLinks.map((link) => (
          <li>
            <a href={link.href} class="text-lg font-medium flex justify-end">
              <span>{link.label}</span>
              <Icon name={link.icon} size={24} />
            </a>
          </li>
        ))
      }
      <div class="divider"></div>
      <li>
        <a href="/courses" class="btn btn-primary"> Explora los cursos </a>
      </li>
    </ul>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const currentPath = window.location.pathname;
    const currentHash = window.location.hash;
    const current = currentPath.concat(currentHash);
    const links = document.querySelectorAll('[data-navlink]');
    links.forEach((el) => {
      const href = el.getAttribute('href');
      if (href === current) {
        el.classList.add('active');
        el.setAttribute('aria-current', 'page');
      } else {
        el.classList.remove('active');
        el.removeAttribute('aria-current');
      }
    });
  });
</script>
